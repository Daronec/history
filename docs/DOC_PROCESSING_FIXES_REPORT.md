# –û—Ç—á–µ—Ç –æ–± –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ DOC —Ñ–∞–π–ª–æ–≤

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ "File is not a zip file"
- **–ü—Ä–æ–±–ª–µ–º–∞**: `docx2txt` –ø—ã—Ç–∞–ª—Å—è –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å —Å—Ç–∞—Ä—ã–µ DOC —Ñ–∞–π–ª—ã –∫–∞–∫ ZIP –∞—Ä—Ö–∏–≤—ã
- **–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–ª–µ–Ω–∞ –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ DOC —Ñ–∞–π–ª–æ–≤:
  - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `antiword` –∏ `catdoc` (–µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã)
  - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `olefile` –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ –∏–∑ OLE —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
  - –†–µ–∑–µ—Ä–≤–Ω—ã–π –º–µ—Ç–æ–¥ - –±–∏–Ω–∞—Ä–Ω–æ–µ —á—Ç–µ–Ω–∏–µ —Å –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ–º —Ç–µ–∫—Å—Ç–∞

### 2. –£–ª—É—á—à–µ–Ω–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ñ–∞–π–ª–æ–≤
- **–ü—Ä–æ–±–ª–µ–º–∞**: –§–∞–π–ª—ã —Å –º–∞–ª—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Ç–µ–∫—Å—Ç–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–ª–∏—Å—å –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- **–†–µ—à–µ–Ω–∏–µ**: 
  - –£–≤–µ–ª–∏—á–µ–Ω–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ —Ç–µ–∫—Å—Ç–∞ –¥–æ 200 —Å–∏–º–≤–æ–ª–æ–≤
  - –î–æ–±–∞–≤–ª–µ–Ω–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ —Ç–µ–∫—Å—Ç–∞
  - –£–ª—É—á—à–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏

### 3. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞
- **–ü—Ä–æ–±–ª–µ–º–∞**: –û—à–∏–±–∫–∞ `'list' object has no attribute 'is_dir'`
- **–†–µ—à–µ–Ω–∏–µ**: 
  - –û–±–Ω–æ–≤–ª–µ–Ω–∞ —Å–∏–≥–Ω–∞—Ç—É—Ä–∞ –º–µ—Ç–æ–¥–∞ `process_new_files`
  - –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–ø–∏—Å–∫–∞ —Ñ–∞–π–ª–æ–≤
  - –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–∏–ø–æ–≤ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### 4. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ olefile
- **–î–æ–±–∞–≤–ª–µ–Ω–æ**: `olefile>=0.46` –≤ requirements.txt
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –î–ª—è —Ä–∞–±–æ—Ç—ã —Å–æ —Å—Ç–∞—Ä—ã–º–∏ DOC —Ñ–∞–π–ª–∞–º–∏ (OLE —Ñ–æ—Ä–º–∞—Ç)

## üß™ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –¢–µ—Å—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ DOC —Ñ–∞–π–ª–æ–≤
```
‚úÖ –£—Å–ø–µ—à–Ω–æ –∏–∑–≤–ª–µ—á–µ–Ω —Ç–µ–∫—Å—Ç: 2,739,932 —Å–∏–º–≤–æ–ª–æ–≤
‚úÖ –£—Å–ø–µ—à–Ω–æ –∏–∑–≤–ª–µ—á–µ–Ω —Ç–µ–∫—Å—Ç: 1,364,631 —Å–∏–º–≤–æ–ª–æ–≤  
‚úÖ –£—Å–ø–µ—à–Ω–æ –∏–∑–≤–ª–µ—á–µ–Ω —Ç–µ–∫—Å—Ç: 2,136,685 —Å–∏–º–≤–æ–ª–æ–≤
```

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ñ–∞–π–ª–æ–≤
- **–ù–∞–π–¥–µ–Ω–æ DOC —Ñ–∞–π–ª–æ–≤**: 18+ —Ñ–∞–π–ª–æ–≤
- **–†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–æ–≤**: –æ—Ç 500KB –¥–æ 6MB
- **–£—Å–ø–µ—à–Ω–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏**: 100% –≤ —Ç–µ—Å—Ç–∞—Ö

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –£–ª—É—á—à–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è load_doc_file()
```python
def load_doc_file(file_path):
    """–ó–∞–≥—Ä—É–∂–∞–µ—Ç DOC —Ñ–∞–π–ª (—Å—Ç–∞—Ä—ã–π —Ñ–æ—Ä–º–∞—Ç Microsoft Word)"""
    # 1. –ü—Ä–æ–±—É–µ–º antiword/catdoc
    # 2. –ü—Ä–æ–±—É–µ–º docx2txt
    # 3. –ò—Å–ø–æ–ª—å–∑—É–µ–º olefile –¥–ª—è OLE —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
    # 4. –†–µ–∑–µ—Ä–≤–Ω—ã–π –º–µ—Ç–æ–¥ - –±–∏–Ω–∞—Ä–Ω–æ–µ —á—Ç–µ–Ω–∏–µ
```

### –£–ª—É—á—à–µ–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
```python
# –£–≤–µ–ª–∏—á–µ–Ω–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞
if len(cleaned_text) > 200:
    # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞
    final_text = clean_text(cleaned_text)
    if final_text and len(final_text.strip()) > 100:
        # –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —Ñ–∞–π–ª
```

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä
```python
def process_new_files(self, data_path: Union[Path, str, List[Path]]) -> List[Dict]:
    # –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–ø–∏—Å–∫–∞ —Ñ–∞–π–ª–æ–≤
    if isinstance(data_path, list):
        all_files = data_path
    # –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
    elif isinstance(data_path, (str, Path)):
        # ... –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
```

## üìä –í–ª–∏—è–Ω–∏–µ –Ω–∞ —Å–∏—Å—Ç–µ–º—É

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π
- ‚ùå –û—à–∏–±–∫–∞ "File is not a zip file" –¥–ª—è DOC —Ñ–∞–π–ª–æ–≤
- ‚ùå –û—à–∏–±–∫–∞ —Ç–∏–ø–æ–≤ –≤ –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–µ
- ‚ùå –ù–∏–∑–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ñ–∞–π–ª–æ–≤

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π
- ‚úÖ –£—Å–ø–µ—à–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ—Ö DOC —Ñ–∞–π–ª–æ–≤
- ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞
- ‚úÖ –£–ª—É—á—à–µ–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –∏ –æ—á–∏—Å—Ç–∫–∞ —Ç–µ–∫—Å—Ç–∞
- ‚úÖ –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞

## üöÄ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

–°–∏—Å—Ç–µ–º–∞ —Ç–µ–ø–µ—Ä—å –≥–æ—Ç–æ–≤–∞ –∫:
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–µ —Å—Ç–∞—Ä—ã—Ö DOC —Ñ–∞–π–ª–æ–≤ Microsoft Word
- ‚úÖ –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–º—É –æ–±—É—á–µ–Ω–∏—é —Å –ª—é–±—ã–º–∏ —Ç–∏–ø–∞–º–∏ —Ñ–∞–π–ª–æ–≤
- ‚úÖ –ù–∞–¥–µ–∂–Ω–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∏ –æ—á–∏—Å—Ç–∫–µ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ü–æ–¥—Ä–æ–±–Ω–æ–º—É –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—é –ø—Ä–æ—Ü–µ—Å—Å–∞ –æ–±—É—á–µ–Ω–∏—è

## üìù –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–î–ª—è –ª—É—á—à–µ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ DOC —Ñ–∞–π–ª–æ–≤** —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `antiword` –∏–ª–∏ `catdoc`
2. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - —Å–ª–µ–¥–∏—Ç–µ –∑–∞ –ª–æ–≥–∞–º–∏ –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
3. **–†–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏** - —Å–æ—Ö—Ä–∞–Ω—è–π—Ç–µ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã –ø–µ—Ä–µ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π
